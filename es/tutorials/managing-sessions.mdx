---
title: "Gestionar sesiones"
description: "Flujo avanzado de sesiones, revisión de historial, estructura de almacenamiento y guía de recuperación."
---

## Por qué importa la disciplina de sesiones

Las sesiones son la memoria a largo plazo de MineClawd. Un flujo limpio de sesiones te da mejores respuestas, menos errores de contexto y recuperación más rápida cuando algo falla.

## Cómo se delimitan las sesiones

- Las sesiones están aisladas por clave de propietario.
- Los comandos de jugador usan el UUID del jugador como clave de propietario.
- Los comandos de consola usan el nombre del origen del comando como clave de propietario.
- Cada propietario tiene un puntero de sesión activa.
- Todos los comandos de sesión requieren nivel de permiso OP `2`.

## Flujo diario de comandos

| Objetivo | Comando |
| --- | --- |
| Empezar con contexto limpio | `/mineclawd sessions new` |
| Ver todas las sesiones guardadas | `/mineclawd sessions list` |
| Cambiar el contexto activo | `/mineclawd sessions resume <session>` |
| Eliminar contexto obsoleto | `/mineclawd sessions remove <session>` |
| Leer el historial actual del chat | `/mineclawd history` |
| Reparar turnos de Vertex mal formados | `/mineclawd sessions repair [session]` |

`<session>` acepta un id corto como `1a2b` o un token como `1a2b-my-build-plan`.

<Tip>
Prefiere el id corto de sesión para notas, scripts y runbooks. El id es estable. La parte de título del token puede cambiar cuando MineClawd genera un título mejor.
</Tip>

## Mejores prácticas para tareas largas

1. Usa una sesión por objetivo, no una sesión para todo.
2. Renueva el contexto iniciando sesiones nuevas en lugar de arrastrar historial viejo para siempre.
3. Ejecuta `/mineclawd sessions list` antes de `resume`, `remove` o `repair`.
4. Evita modificar sesiones mientras una solicitud sigue en ejecución.
5. Revisa el contexto con `/mineclawd history` antes de tareas destructivas.

## Cómo usar bien `/mineclawd history`

- El libro de historial muestra token de sesión, hora de actualización y turnos visibles de chat.
- El comando solo funciona para jugadores, no para consola.
- La interfaz de libro de historial requiere MineClawd en el cliente.
- El historial muy largo se recorta a los límites de páginas del libro de Minecraft.

Si tu cliente no tiene MineClawd instalado, usa `sessions list` junto con logs recientes de chat como verificación de contexto alternativa.

## Guía de recuperación

### La solicitud falló pero el contexto debe mantenerse

Usa `/mineclawd retry <token>` desde el último mensaje de fallo. Los tokens de reintento vencen después de 30 minutos.

### Errores de desajuste en function-call de Vertex

Ejecuta:

```bash
/mineclawd sessions repair
```

O apunta a una sesión específica:

```bash
/mineclawd sessions repair <session>
```

`repair` normaliza turnos de function-call de Vertex mal formados y guarda la sesión corregida.

## Ubicación de archivos de sesión

MineClawd guarda las sesiones dentro de tu directorio de juego:

```text
mineclawd/
  sessions/
    <owner>/
      active.json
      <id>.json
```

- `active.json` guarda el id de sesión activa.
- `<id>.json` guarda metadatos y ambos historiales de proveedor (`openAiHistory`, `vertexHistory`).
- Si eliminas la sesión activa, MineClawd selecciona automáticamente la sesión restante más recientemente actualizada. Si no queda ninguna, se limpia la sesión activa.

## Estrategia de respaldo y limpieza

1. Haz respaldo de `mineclawd/sessions/` antes de una limpieza masiva.
2. Elimina sesiones obsoletas con `/mineclawd sessions remove <session>`.
3. Conserva una sesión conocida como estable por operador para rollback rápido.
4. Usa `/resources/technical-details` cuando necesites inspeccionar internals de almacenamiento.

## Páginas relacionadas

- [/commands/sessions-list](/commands/sessions-list)
- [/commands/sessions-resume](/commands/sessions-resume)
- [/commands/sessions-repair](/commands/sessions-repair)
- [/commands/history](/commands/history)
