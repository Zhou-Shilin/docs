---
title: "マルチプレイで使う"
description: "専用サーバーで MineClawd を運用するための、明確な権限設計、表示制御、安全なロールアウト手順。"
---

## デプロイモデル

- サーバーに MineClawd を導入すると `/mineclawd` と `/mclawd` が有効になります。
- コアコマンド利用だけならクライアント導入は任意です。
- 次の機能にはクライアント導入が必要です:
  - `/mineclawd config` GUI オープンパケット
  - `/mineclawd history` 本 UI
  - `ask-user-question` のポップアップ質問 UI

<Info>
プレイヤーがクライアント Mod を入れていなくても、MineClawd にはチャット経由の質問フォールバック（`/mineclawd choose ...`）があります。
</Info>

<Info>
クライアント Mod なしでも、設定はチャットで `/mineclawd config <key> <value>` を使えます。
</Info>

## 権限モデルと管理者制御

- MineClawd コマンドルートは vanilla 権限レベル `2`（`source.hasPermissionLevel(2)`）で保護されます。
- サブコマンド単位の独自権限ノードは組み込みで提供されません。
- 実務上の結論: 信頼できるオペレーターのみに OP を付与してください。

サーバースタックがコマンド単位の権限再マッピングをサポートする場合、`/mineclawd` と `/mclawd` は AI オペレーター役割のみに公開してください。

## 混雑サーバー向け表示制御

MineClawd にはプレイヤーごとの表示設定があります:

```bash
/mineclawd config broadcast-requests-to <self|all|ops>
```

- `self`: プロンプトのエコーとタスク状態を依頼者だけが見ます。
- `all`: 全員が見ます。
- `ops`: OP のみが見ます。

この設定は `mineclawd/player-settings.json` に保存され、プレイヤー UUID ごとに管理されます。

GUI 設定画面の "Misc" セクションにある "Broadcast requests to" からも設定できます。

## マルチプレイでのセッション所有

- セッションデータは owner key ごとに分離されます。
- プレイヤーコマンドはそのプレイヤー自身のセッション集合を操作します。
- コンソールコマンドは別の owner 名前空間を使います。

チーム運用では、各オペレーターが個別セッションを使うか、全員で 1 つの運用アカウントを共有するかを早めに決めてください。

## 専用サーバーでの dynamic registry

デフォルトの `dynamic-registry-mode` は `AUTO` です。`AUTO` では、専用サーバーで動的プレースホルダー実行時機能は無効です。

強制有効にするには:

```bash
/mineclawd config dynamic-registry-mode enabled
```

その後サーバーを再起動します。

### 有効化時の変更点

- item/block/fluid スロット向け動的プレースホルダーが実行時に利用可能になります。
- 動的状態同期がクライアントへ送信されます。
- 永続ワールド状態に動的スロットデータが保存されます。
- この専用サーバーに参加するクライアントにも MineClawd 導入が必要になります。

<Warning>
本番サーバーで dynamic registry を有効化するのは段階的テスト後にしてください。クライアント要件は全プレイヤーに影響する互換性変更です。
</Warning>

## 推奨オペレーターベースライン

| 目的 | 推奨設定 |
| --- | --- |
| チャットノイズを減らす | `broadcast-requests-to ops` |
| 長いツールループを防ぐ | `limit-tool-calls true` |
| ループ上限を明確にする | `tool-call-limit 8` から `12` |
| 障害調査時のみデバッグ | `debug-mode true` を一時的に |

## サーバーオーナー向けロールアウトチェックリスト

1. 先にオペレーター役割と OP ポリシーを決める。
2. プロバイダーとモデルの認証情報を設定する。
3. 表示ポリシー（`self`, `ops`, `all`）を設定する。
4. dynamic registry を `auto` のままにするか `enabled` に変えるか決める。
5. 公開前に実アカウント 2 つ（オペレーターと非オペレーター）でテストする。

## 関連ページ

- [/commands/overview](/commands/overview)
- [/commands/config](/commands/config)
- [/configuration/complete-config](/configuration/complete-config)
- [/resources/troubleshooting](/resources/troubleshooting)
